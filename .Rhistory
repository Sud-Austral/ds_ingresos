# saveRDS(casen2017,"C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/casen/casen_2017_c2.rds")
# saveRDS(casen2015,"C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/casen/casen_2015_c2.rds")
# saveRDS(casen2013,"C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/casen/casen_2013_c2.rds")
# saveRDS(casen2011,"C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/casen/casen_2011_c2.rds")
codigos_comunales <- readRDS(file = "C:/Users/chris/OneDrive/Documentos/archivos_grandes/codigos_comunales_2011-2017.rds")
#codigos_comunales <- readRDS(file = "C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/codigos_comunales_2011-2017.rds")
funcion1 <- function(n){
xx<-switch(n,"2011","2013","2015","2017","2020")
tanios <<- xx
expan<-switch(n,"expc_full","expc","expc_todas","expc","expc")
if(xx==2011) {
eliminated <- casen2011
a <- eliminated$ytotaj#ytothaj
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2011
}
if(xx==2013) {
eliminated <- casen2013
a <- eliminated$ytotcor#ytotcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2013
}
if(xx==2015) {
eliminated <- casen2015
a <- eliminated$ytotcor#ytotcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2015
}
if(xx==2017) {
eliminated <- casen2017
a <- eliminated$ytotcor#ytotcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2017
}
if(xx==2020) {
eliminated <- casen2020
a <- eliminated$ytotcor#ytotcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2020
}
tpi <- "ytotcor"
promedios_grupales <-aggregate(a, by=list(b, c, d), FUN = mean , na.rm = TRUE)
promedios_grupales_sd <-aggregate(a, by=list(b, c, d), FUN = sd , na.rm = TRUE)
promedios_grupales_gini <-aggregate(a, by=list(b, c, d), FUN = gini , na.rm = TRUE)
promedios_grupales$sd = promedios_grupales_sd$sd.a
promedios_grupales$gini = promedios_grupales_gini$gini.a
df<-promedios_grupales
df$Año <- anio
df$tipo_ingreso <- tpi
tabla_matp <-xtabs(eliminated[,(expan)]~b+c+d, data = eliminated)
tabla_matp <- as.data.frame(tabla_matp)
tabla_matp <-tabla_matp[!(tabla_matp$Freq == 0),]
df$freq <- tabla_matp$Freq
df <- df[complete.cases(df), ]
names(df)[1] <- "Comuna"
names(df)[2] <- "Sexo"
names(df)[3] <- "Etnia"
names(df)[4] <- "Promedio del Ingreso"
names(df)[5] <- "Desviación standard"
names(df)[6] <- "Gini"
names(df)[7] <- "Año"
names(codigos_comunales)[1] <- "Código"
names(codigos_comunales)[2] <- "Comuna"
# codigos_comunales
df_tabla = merge( x = df, y = codigos_comunales, by = "Comuna", all.x = TRUE)
df <-df_tabla[!(df_tabla$Promedio == 0),]
tabla <<- df
}
for (n in 1:5){
funcion1(n)
assign(paste0("tabla","_",tanios),tabla)
}
tabla_cont_freq <- rbind(tabla_2011,tabla_2013,tabla_2015,tabla_2017,tabla_2020)
datatable(tabla_cont_freq, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='csv',
filename = 'hitStats'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
codigos_comunales <- readRDS(file = "C:/Users/chris/OneDrive/Documentos/archivos_grandes/codigos_comunales_2011-2017.rds")
#codigos_comunales <- readRDS(file = "C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/codigos_comunales_2011-2017.rds")
funcion1 <- function(n){
xx<-switch(n,"2011","2013","2015","2017","2020")
tanios <<- xx
expan<-switch(n,"expc_full","expc","expc_todas","expc","expc")
if(xx==2011) {
eliminated <- casen2011
a <- eliminated$yautaj#yauthaj
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2011
tpi <- "yautcor"
}
if(xx==2013) {
eliminated <- casen2013
a <- eliminated$yautcor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2013
tpi <- "yautcor"
}
if(xx==2015) {
eliminated <- casen2015
a <- eliminated$yautcor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2015
tpi <- "yautcor"
}
if(xx==2017) {
eliminated <- casen2017
a <- eliminated$yautcor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2017
tpi <- "yautcor"
}
if(xx==2020) {
eliminated <- casen2020
a <- eliminated$yautcor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2020
tpi <- "yautcor"
}
promedios_grupales <-aggregate(a, by=list(b, c, d), FUN = mean , na.rm = TRUE)
promedios_grupales_sd <-aggregate(a, by=list(b, c, d), FUN = sd , na.rm = TRUE)
promedios_grupales_gini <-aggregate(a, by=list(b, c, d), FUN = gini , na.rm = TRUE)
promedios_grupales$sd = promedios_grupales_sd$sd.a
promedios_grupales$gini = promedios_grupales_gini$gini.a
df<-promedios_grupales
df$Año <- anio
df$tipo_ingreso <- tpi
tabla_matp <-xtabs(eliminated[,(expan)]~b+c+d, data = eliminated)
tabla_matp <- as.data.frame(tabla_matp)
tabla_matp <-tabla_matp[!(tabla_matp$Freq == 0),]
df$freq <- tabla_matp$Freq
df <- df[complete.cases(df), ]
names(df)[1] <- "Comuna"
names(df)[2] <- "Sexo"
names(df)[3] <- "Etnia"
names(df)[4] <- "Promedio del Ingreso"
names(df)[5] <- "Desviación standard"
names(df)[6] <- "Gini"
names(df)[7] <- "Año"
names(codigos_comunales)[1] <- "Código"
names(codigos_comunales)[2] <- "Comuna"
# codigos_comunales
df_tabla = merge( x = df, y = codigos_comunales, by = "Comuna", all.x = TRUE)
df <-df_tabla[!(df_tabla$Promedio == 0),]
tabla <<- df
}
for (n in 1:5){
funcion1(n)
assign(paste0("tabla","_",tanios),tabla)
}
tabla_cont_freq <- rbind(tabla_2011,tabla_2013,tabla_2015,tabla_2017,tabla_2020)
datatable(tabla_cont_freq, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='csv',
filename = 'hitStats'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
codigos_comunales <- readRDS(file = "C:/Users/chris/OneDrive/Documentos/archivos_grandes/codigos_comunales_2011-2017.rds")
#codigos_comunales <- readRDS(file = "C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/codigos_comunales_2011-2017.rds")
funcion1 <- function(n){
xx<-switch(n,"2011","2013","2015","2017","2020")
tanios <<- xx
expan<-switch(n,"expc_full","expc","expc_todas","expc","expc")
if(xx==2011) {
eliminated <- casen2011
a <- eliminated$ytrabaj#yauthaj
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2011
}
if(xx==2013) {
eliminated <- casen2013
a <- eliminated$ytrabajoCor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2013
}
if(xx==2015) {
eliminated <- casen2015
a <- eliminated$ytrabajoCor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2015
}
if(xx==2017) {
eliminated <- casen2017
a <- eliminated$ytrabajocor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2017
}
if(xx==2020) {
eliminated <- casen2020
a <- eliminated$ytrabajocor#yautcorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2020
}
tpi <- "ytrabajocor"
promedios_grupales <-aggregate(a, by=list(b, c, d), FUN = mean , na.rm = TRUE)
promedios_grupales_sd <-aggregate(a, by=list(b, c, d), FUN = sd , na.rm = TRUE)
promedios_grupales_gini <-aggregate(a, by=list(b, c, d), FUN = gini , na.rm = TRUE)
promedios_grupales$sd = promedios_grupales_sd$sd.a
promedios_grupales$gini = promedios_grupales_gini$gini.a
df<-promedios_grupales
df$Año <- anio
df$tipo_ingreso <- tpi
tabla_matp <-xtabs(eliminated[,(expan)]~b+c+d, data = eliminated)
tabla_matp <- as.data.frame(tabla_matp)
tabla_matp <-tabla_matp[!(tabla_matp$Freq == 0),]
df$freq <- tabla_matp$Freq
df <- df[complete.cases(df), ]
names(df)[1] <- "Comuna"
names(df)[2] <- "Sexo"
names(df)[3] <- "Etnia"
names(df)[4] <- "Promedio del Ingreso"
names(df)[5] <- "Desviación standard"
names(df)[6] <- "Gini"
names(df)[7] <- "Año"
names(codigos_comunales)[1] <- "Código"
names(codigos_comunales)[2] <- "Comuna"
# codigos_comunales
df_tabla = merge( x = df, y = codigos_comunales, by = "Comuna", all.x = TRUE)
df <-df_tabla[!(df_tabla$Promedio == 0),]
tabla <<- df
}
for (n in 1:5){
funcion1(n)
assign(paste0("tabla","_",tanios),tabla)
}
tabla_cont_freq <- rbind(tabla_2011,tabla_2013,tabla_2015,tabla_2017,tabla_2020)
datatable(tabla_cont_freq, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='csv',
filename = 'hitStats'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
# codigos_comunales <- readRDS(file = "C:/Users/enamo/Desktop/Shiny-R/Casen_en_pandemia_2020/codigos_comunales_2011-2017.rds")
funcion1 <- function(n){
xx<-switch(n,"2011","2013","2015","2017","2020")
tanios <<- xx
expan<-switch(n,"expc_full","expc","expc_todas","expc","expc")
if(xx==2011) {
eliminated <- casen2011
a <- eliminated$yopraj#yauthaj
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2011
tpi <- "yoprcor"
}
if(xx==2013) {
eliminated <- casen2013
a <- eliminated$yoprCor#ytrabajocorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r6 #etnia
anio <- 2013
tpi <- "yoprcor"
}
if(xx==2015) {
eliminated <- casen2015
a <- eliminated$yoprCor#ytrabajoCorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2015
tpi <- "yoprcor"
}
if(xx==2017) {
eliminated <- casen2017
a <- eliminated$yoprcor#ytrabajocorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2017
tpi <- "yoprcor"
}
if(xx==2020) {
eliminated <- casen2020
a <- eliminated$yoprcor#ytrabajocorh
b <- eliminated$comuna
c <- eliminated$sexo
d <- eliminated$r3 #etnia
anio <- 2020
tpi <- "yoprcor"
}
promedios_grupales <-aggregate(a, by=list(b, c, d), FUN = mean , na.rm = TRUE)
promedios_grupales_sd <-aggregate(a, by=list(b, c, d), FUN = sd , na.rm = TRUE)
promedios_grupales_gini <-aggregate(a, by=list(b, c, d), FUN = gini , na.rm = TRUE)
promedios_grupales$sd = promedios_grupales_sd$sd.a
promedios_grupales$gini = promedios_grupales_gini$gini.a
df<-promedios_grupales
df$Año <- anio
df$tipo_ingreso <- tpi
tabla_matp <-xtabs(eliminated[,(expan)]~b+c+d, data = eliminated)
tabla_matp <- as.data.frame(tabla_matp)
tabla_matp <-tabla_matp[!(tabla_matp$Freq == 0),]
df$freq <- tabla_matp$Freq
df <- df[complete.cases(df), ]
names(df)[1] <- "Comuna"
names(df)[2] <- "Sexo"
names(df)[3] <- "Etnia"
names(df)[4] <- "Promedio del Ingreso"
names(df)[5] <- "Desviación standard"
names(df)[6] <- "Gini"
names(df)[7] <- "Año"
names(codigos_comunales)[1] <- "Código"
names(codigos_comunales)[2] <- "Comuna"
# codigos_comunales
df_tabla = merge( x = df, y = codigos_comunales, by = "Comuna", all.x = TRUE)
df <-df_tabla[!(df_tabla$Promedio == 0),]
tabla <<- df
}
for (n in 1:5){
funcion1(n)
assign(paste0("tabla","_",tanios),tabla)
}
tabla_cont_freq <- rbind(tabla_2011,tabla_2013,tabla_2015,tabla_2017,tabla_2020)
datatable(tabla_cont_freq, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='csv',
filename = 'hitStats'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
unique(casen2006$CORTE)
tabla_matp <-xtabs(casen2006$EXPC~COMUNA+CORTE, data = casen2006)
head(tabla_matp,10)
s1 <- sum(tabla_matp[,1])+sum(tabla_matp[,2])+sum(tabla_matp[,3])
s2 <- sum(tabla_matp[,1])
s2*100/s1
casen_2006_r1 <- filter(casen2006, casen2006$R == "VIII")
# head(casen_2006_r1)
# casen_2006_r1 %>% filter(!is.na(CORTE))
tabla_matp <-xtabs(casen_2006_r1$EXPR~R+CORTE, data = casen_2006_r1)
# head(tabla_matp,10)
s1 <- sum(tabla_matp[,1])+sum(tabla_matp[,2])+sum(tabla_matp[,3])
s2 <- sum(tabla_matp[,3])
s2*100/s1
options(scipen=999)
casen2017_algarrobo <- filter(casen2017, casen2017$comuna == "Aysén")
casen2017_algarrobo_head <- casen2017_algarrobo
casen2017_algarrobo_head <- casen2017_algarrobo_head[,c("comuna","folio","ytot", "ytotcor","ytoth","yaimh","yaimcorh","ytotcorh")]
casen2017_algarrobo_head_sin_na <- mutate_at(casen2017_algarrobo_head, c("ytot", "ytotcor", "ytoth", "yaimh","yaimcorh","ytotcorh"), ~replace(., is.na(.), 0))
casen2017_algarrobo_head_sin_na$ytotcorh_sin_ah <- (casen2017_algarrobo_head_sin_na$ytotcorh - casen2017_algarrobo_head_sin_na$yaimcorh)
tabla <- table(casen2017_algarrobo_head_sin_na$folio)
tabla <- as.data.frame(tabla)
colnames(tabla) <- c("folio","freq_folio")
casen_fh <- casen2017_algarrobo_head_sin_na[,c("comuna","folio", "ytotcor","yaimcorh","ytotcorh","ytotcorh_sin_ah")]
casen_fh$folio <- as.character(casen_fh$folio)
repetidos2 <- merge(x=casen_fh, y=tabla, by = "folio", all.x = T)
rr <- repetidos2
datatable(rr, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
fn_prom <- function(n){
# ningreso<-switch(n,"ytotcorh","ytotcorh","ytotcorh") #"yoprhaj","yoprCorh",
nfolio<-switch(n,"folio.x","folio","folio")#"folio","folio",
xx<-switch(n,"2015","2017","2020")
tanios <<- xx
switch (n,
case = tabla_casen <- casen2015,
case = tabla_casen <- casen2017,
case = tabla_casen <- casen2020
)
receptaculo <- data.frame()
comunas <- unique(tabla_casen$comuna)
# sort(comunas)[1:10]
for (j in sort(comunas)[1:10]) {
options(scipen=999)
casen2017_algarrobo <- filter(tabla_casen, tabla_casen$comuna == j)
casen2017_algarrobo_head <- casen2017_algarrobo
casen2017_algarrobo_head <- casen2017_algarrobo_head[,c("comuna",nfolio,"ytotcor","yaimcorh","ytotcorh")]
names(casen2017_algarrobo_head)[2] <- "folio"
casen2017_algarrobo_head_sin_na <- mutate_at(casen2017_algarrobo_head, c("ytotcor","yaimcorh","ytotcorh"), ~replace(., is.na(.), 0))
casen2017_algarrobo_head_sin_na$ytotcorh_sin_ah <- (casen2017_algarrobo_head_sin_na$ytotcorh - casen2017_algarrobo_head_sin_na$yaimcorh)
tabla <- table(casen2017_algarrobo_head_sin_na$folio)
tabla <- as.data.frame(tabla)
colnames(tabla) <- c("folio","freq_folio")
casen_fh <- casen2017_algarrobo_head_sin_na[,c("comuna","folio", "ytotcor","yaimcorh","ytotcorh","ytotcorh_sin_ah")]
casen_fh$folio <- as.character(casen_fh$folio)
repetidos2 <- merge(x=casen_fh, y=tabla, by = "folio", all.x = T)
rr <- repetidos2
calculos <- data.frame(
comuna = j,
prom_personas_ytotcor = mean(rr$ytotcor),
prom_hogares_sin_ing_imput_ytotcor = mean(rr$ytotcorh_sin_ah/rr$freq_folio),
prom_hogares_ytotcor = mean(rr$ytotcorh/rr$freq_folio)
)
colnames(calculos) <- c("comuna",paste0("prom_personas_ytotcor_",xx),paste0("prom_hogares_sin_ing_imput_ytotcor_",xx),paste0("prom_hogares_ytotcor_",xx))
receptaculo <- rbind(receptaculo,calculos)
}
calculados <<- receptaculo
# print(calculados)
}
for (n in 1:3) {
fn_prom(n)
assign(paste0("calculados_",tanios),calculados)
}
receptaculo_unido = merge(x = calculados_2017, y = calculados_2020, by = "comuna", all.x = T)
receptaculo_unido = merge(x = calculados_2015, y = receptaculo_unido, by = "comuna", all.x = T)
datatable(receptaculo_unido, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
p <- plot_ly(receptaculo_unido, width = 1200, x = ~comuna, y = ~prom_hogares_ytotcor_2015, name = 'Promedio de hogares(con Alquiler imputado) 2015', mode = 'markers' ) %>% add_trace()
p <- p %>% add_trace(y = ~prom_hogares_ytotcor_2017, name = 'Promedio de hogares(con Alquiler imputado) 2017', mode = 'markers')
p <- p %>% add_trace(y = ~prom_hogares_ytotcor_2020, name = 'Promedio de hogares(con Alquiler imputado) 2020', mode = 'markers')
p <- p %>% add_lines(y = ~prom_hogares_sin_ing_imput_ytotcor_2015, name = 'Promedio de hogares(sin Alquiler imputado) 2015', mode = 'lines+markers')
p <- p %>% add_lines(y = ~prom_hogares_sin_ing_imput_ytotcor_2017, name = 'Promedio de hogares(sin Alquiler imputado) 2017', mode = 'lines+markers')
p <- p %>% add_lines(y = ~prom_hogares_sin_ing_imput_ytotcor_2020, name = 'Promedio de hogares(sin Alquiler imputado) 2020', mode = 'lines+markers')
p <- p %>% add_lines(y = ~prom_personas_ytotcor_2015, name = 'Promedio de personas 2015', mode = 'lines+markers')
p <- p %>% add_lines(y = ~prom_personas_ytotcor_2017, name = 'Promedio de personas 2017', mode = 'lines+markers')
p <- p %>% add_lines(y = ~prom_personas_ytotcor_2020, name = 'Promedio de personas 2020', mode = 'lines+markers')
p
fu_ingresos <- function(n){
# n <- 3
ningreso<-switch(n,"yauthaj","yautcorh","yautcorh","yautcorh","yautcorh")
nfolio<-switch(n,"folio","folio","folio.x","folio","folio")
nregion<-switch(n,"Metropolitana","Metropolitana","Región Metropolitana de Santiago","Región Metropolitana de Santiago","Región Metropolitana de Santiago")
expan<-switch(n,"expc_full","expc","expc_todas","expc","expc")
xx<-switch(n,"2011","2013","2015","2017","2020")
tanios <<- xx
switch (n,
# case = tabla_casen <- casen2009,
case = tabla_casen <- casen2011,
case = tabla_casen <- casen2013,
case = tabla_casen <- casen2015,
case = tabla_casen <- casen2017,
case = tabla_casen <- casen2020
)
casen2011_rm <- tabla_casen
#casen2011_rm <- filter(tabla_casen, tabla_casen$region == nregion)
tabla <- table(casen2011_rm[,c(nfolio)])
tabla <- as.data.frame(tabla)
colnames(tabla) <- c("folio","freq_folio")
casen_fh <- casen2011_rm[,c("comuna",nfolio,ningreso,expan)]
casen_fh$folio <- as.character(casen_fh$folio)
repetidos2 <- merge(x=casen_fh, y=tabla, by = "folio", all.x = T)
rr <- repetidos2[!duplicated(repetidos2$folio), ]
rr$ing_per_h <- rr[,c(ningreso)]/rr$freq_folio
aaa <- aggregate(rr$ing_per_h, list(rr$comuna), FUN=mean)
names(aaa)[1]<-c("Comuna")
aaa$`mean.rr$ing_per_h` <- as.numeric(aaa$`mean.rr$ing_per_h`)
names(aaa)[2]<-c("calculo_propio")
write_xlsx(aaa, "aaaa.xlsx")
aaa$año <- xx
aaaa <<- aaa
}
for (n in 1:5) {
fu_ingresos(n)
assign(paste0("per","_",tanios),aaaa)
}
